<html>
  <head>

  </head>
  <body>
    <div>
      <button onclick="send()">
        자동 재생 시작
      </button>
    </div>
    <script>
      var VIDEO_TIMEOUT = 240000;
      var MAX_VIDEO_OFFSET = 25;
      var MAX_PAGE_OFFSET = 24;

      var pageOffSet = 1,
          videoOffset = 1;

      function send() {
        var httpRequest = new XMLHttpRequest();
        function reqListener () {
          if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
              var videoLink = httpRequest.responseText;
              var openedWindow = window.open(videoLink, '_blank');
              setTimeout(() => {
                videoOffset += 1;
                openedWindow.close();

                if (videoOffset > MAX_VIDEO_OFFSET) {
                  pageOffSet += 1;
                  videoOffset = 1;
                }

                if (pageOffSet === MAX_PAGE_OFFSET) {
                  pageOffSet = 1;
                  videoOffset = 1;
                }
                getUrl();
              }, VIDEO_TIMEOUT);
            } else { 
              alert("실패: " + httpRequest.status);
            }
          }
        }

        function getUrl() {
          httpRequest.onreadystatechange = reqListener;
          httpRequest.open("GET", "http://localhost:8080/api/autoplay?" + "page=" + pageOffSet + "&video=" + videoOffset);
          httpRequest.send();
        }
        getUrl();
      }
    </script>
  </body>
</html>